<lib-sequencer></lib-sequencer>
<button mat-button (click)="start()">Start (CLICK FIRST)</button>
<button mat-button (click)="stop()">Stop</button>
@let keyEvent = keyEvent$ | async;

<mat-card class="keyboard-container">
  <div class="top-keys">
    @for(key of noteMap; track key) { @if(key.accidental) {
    <span
      [ngStyle]="{
        'margin-left': key.note === 'F' ? '50px' : '0px'
      }"
    >
      <button
        class="key"
        [ngClass]="{
          'key-pressed': key.keyCode === keyEvent?.code ? true : false
        }"
        (click)="playNote(key.note)"
      >
        {{ key.note }}{{ key.accidental }}
      </button>
    </span>

    } }
  </div>
  <div class="bottom-keys">
    @for(key of noteMap; track key) { @if(!key.accidental) {
    <button
      class="key"
      [ngClass]="{
        'key-pressed': key.keyCode === keyEvent?.code ? true : false
      }"
      (click)="playNote(key.note)"
    >
      {{ key.note }}
    </button>
    } }
  </div>
</mat-card>

<!-- <mat-card style="margin-top: 15px; margin-right: 25px">
  <mat-form-field>
    <mat-label>Attack</mat-label>
    <input
      matInput
      type="number"
      min="0"
      max="2"
      [(ngModel)]="asdr.envelope.attack"
      (ngModelChange)="updateEnvelope()"
    />
  </mat-form-field>

  <mat-form-field>
    <mat-label>Decay</mat-label>
    <input
      matInput
      type="number"
      min="0"
      max="2"
      step="0.01"
      [(ngModel)]="asdr.envelope.decay"
      (ngModelChange)="updateEnvelope()"
    />
  </mat-form-field>

  <mat-form-field>
    <mat-label>Sustain</mat-label>
    <input
      matInput
      type="number"
      min="0"
      max="2"
      [(ngModel)]="asdr.envelope.sustain"
      (ngModelChange)="updateEnvelope()"
    />
  </mat-form-field>

  <mat-form-field>
    <mat-label>Release</mat-label>
    <input
      matInput
      type="number"
      min="0"
      max="2"
      [(ngModel)]="asdr.envelope.release"
      (ngModelChange)="updateEnvelope()"
    />
  </mat-form-field>
</mat-card> -->

<mat-card class="example-result-card" style="width: 250px">
  <mat-card-content>
    <span>Attack</span>
    <mat-slider class="example-margin" [max]="2" [min]="0" [step]=".01">
      <input
        matSliderThumb
        [(ngModel)]="asdr.envelope.attack"
        (ngModelChange)="updateEnvelope()"
        #slider
      />
    </mat-slider>
    <span>Sustain</span>
    <mat-slider class="example-margin" [max]="1" [min]="0" [step]=".01">
      <input
        matSliderThumb
        [(ngModel)]="asdr.envelope.sustain"
        (ngModelChange)="updateEnvelope()"
        #slider
      />
    </mat-slider>
    <span>Decay</span>
    <mat-slider class="example-margin" [max]="2" [min]="0" [step]=".01">
      <input
        matSliderThumb
        [(ngModel)]="asdr.envelope.decay"
        (ngModelChange)="updateEnvelope()"
        #slider
      />
    </mat-slider>
    <span>Release</span>
    <mat-slider class="example-margin" [max]="2" [min]="0" [step]=".01">
      <input
        matSliderThumb
        [(ngModel)]="asdr.envelope.release"
        (ngModelChange)="updateEnvelope()"
        #slider
      />
    </mat-slider>
    
  </mat-card-content>
</mat-card>

<!-- <button mat-button (click)="toggle()">Toggle Open/Close</button> -->
